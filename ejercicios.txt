

EJERCICIO 1

SELECT title_id, sum((titles.price * sales.qty * titles.royalty / 100 * titleauthor.royaltyper / 100)) as sales_royalty FROM publications.sales 
left join titles using(title_id) left join titleauthor using(title_id) group by title_id, au_id order by sales_royalty desc limit 3;


EJERCICIO 2

SELECT au_id as Author , sum(price*qty *royalty / 100 *royaltyper/ 100) as sales_royalty
FROM publications.authors
LEFT JOIN publications.titleauthor using (au_id)
LEFT JOIN publications.sales using (title_id) 
LEFT JOIN publications.titles using (title_id)
Group by title_id, au_id
order by sales_royalty DESC;
